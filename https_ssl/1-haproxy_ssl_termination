# 1-haproxy_ssl_termination
# SSL Termination + HTTP Redirect with static 200 response

global
    daemon
    maxconn 2048
    tune.ssl.default-dh-param 2048

defaults
    mode http
    option httplog
    option dontlognull
    timeout connect 5000
    timeout client 50000
    timeout server 50000

# Redirect all HTTP traffic to HTTPS
frontend http_in
    bind *:80
    redirect scheme https code 301 if !{ ssl_fc }

# HTTPS frontend
frontend https_in
    bind *:443 ssl crt /etc/ssl/private/haproxy.pem
    default_backend web_backend

# Backend serving inline static 200 response
backend web_backend
    http-request return status 200 content-type "text/html" string "Holberton School for the win!"
