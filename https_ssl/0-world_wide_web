#!/usr/bin/env bash
# 0-world_wide_web
# Displays DNS information for subdomains

domain="$1"
subdomain="$2"

# Function to fetch record type and destination using dig + awk
check_record() {
    local full="$1.$domain"

    # Extract answer line
    local line
    line=$(dig "$full" | awk '/ANSWER SECTION/{getline; print}')

    # If empty, treat as no record
    if [ -z "$line" ]; then
        echo "The subdomain $1 is a  record and points to "
        return
    fi

    # Example line:
    # www.domain.com.   87   IN   A   54.210.47.110
    local type dest
    type=$(echo "$line" | awk '{print $4}')
    dest=$(echo "$line" | awk '{print $5}')

    echo "The subdomain $1 is a $type record and points to $dest"
}

# If 2nd parameter exists â†’ check only that subdomain
if [ -n "$subdomain" ]; then
    check_record "$subdomain"
    exit 0
fi

# Otherwise check all 4 required subdomains in order
for s in www lb-01 web-01 web-02; do
    check_record "$s"
done
